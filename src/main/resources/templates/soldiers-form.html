<div th:fragment="content">
    <h2 class="text-2xl font-bold mb-6 text-gray-800"
        th:text="${zolnierz.id == null ? 'Dodaj Nowego Żołnierza' : 'Edytuj Żołnierza'}"></h2>

    <form th:action="@{/soldiers/save}" th:object="${zolnierz}" method="post">
        <input type="hidden" th:field="*{id}" />

        <div class="form-group">
            <label for="imie">Imię:</label>
            <input type="text" id="imie" th:field="*{imie}" required class="input" />
        </div>

        <div class="form-group">
            <label for="nazwisko">Nazwisko:</label>
            <input type="text" id="nazwisko" th:field="*{nazwisko}" required class="input" />
        </div>

        <div class="form-group">
            <label for="pesel">PESEL:</label>
            <input type="text" id="pesel" th:field="*{pesel}" required pattern="\d{11}" title="PESEL musi składać się z 11 cyfr" class="input" />
        </div>

        <div class="form-group">
            <label for="ranga">Ranga:</label>
            <select id="ranga" th:field="*{ranga}" required class="input">
                <option value="">Wybierz rangę</option>
                <option th:each="r : ${rangaOptions}" th:value="${r}" th:text="${r}"></option>
            </select>
        </div>

        <div class="form-group">
            <label for="status">Status:</label>
            <select id="status" th:field="*{status}" required class="input" onchange="toggleObrazeniaField()">
                <option value="">Wybierz status</option>
                <option th:each="s : ${statusOptions}" th:value="${s}" th:text="${s}"></option>
            </select>
        </div>

        <div class="form-group" id="obrazeniaGroup"
             th:if="${zolnierz.status != null and zolnierz.status.name() == 'SZPITAL_POLOWY'}">
            <label for="obrazenia">Obrażenia:</label>
            <input type="text" id="obrazenia" th:field="*{obrazenia}" class="input" />
        </div>

        <div class="flex justify-end gap-4 mt-6">
            <button type="submit" class="btn btn-primary">Zapisz</button>
            <a th:href="@{/soldiers}" class="btn btn-secondary">Anuluj</a>
        </div>
    </form>

    <script>
        function toggleObrazeniaField() {
            const statusSelect = document.getElementById('status');
            const obrazeniaGroup = document.getElementById('obrazeniaGroup');
            const obrazeniaInput = document.getElementById('obrazenia');
            if (!statusSelect || !obrazeniaGroup || !obrazeniaInput) return;
            if (statusSelect.value === 'SZPITAL_POLOWY') {
                obrazeniaGroup.style.display = 'block';
            } else {
                obrazeniaGroup.style.display = 'none';
                obrazeniaInput.value = '';
            }
        }
        document.addEventListener('DOMContentLoaded', toggleObrazeniaField);
    </script>
</div>